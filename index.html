<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Climate Change: Alyssa Bleize</title>

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">

</head>

<body>
    <h1>
        Climate Change
    </h1>

    <h4>
        The heat is on!

    </h4>

    <h5>
        Alyssa Bleize
    </h5>

    <p class="titel">
        Het klimaat is altijd in beweging
    </p>

    <br>

    <p class="one">
        Natuurlijke en menselijke invloeden zorgen voor verandering. Zo is de gemiddelde temperatuur van de aarde in de
        afgelopen 130 jaar met 1 graad gestegen.
    </p>
    <br>
    <br>
    <p class="two">
        Ook is de zeespiegel in die tijd met 20 centimeter gestegen. Klimaatverandering heeft grote gevolgen voor mens,
        natuur en milieu. Het klimaat verandert door veel verschillende oorzaken, zoals: de toename van broeikasgassen
        in de lucht, vulkaanuitbarstingen,
        meteorietinslagen. Sinds de industriële revolutie is de invloed van de mens op het klimaat snel groter geworden.
        Broeikasgassen zorgen ervoor dat warmte wordt vastgehouden en daardoor stijgt de temperatuur op aarde. Zonder
        broeikasgassen zou de
        aarde ijskoud zijn, maar met teveel broeikasgassen wordt het juist te heet. De toename van CO2 komt vooral door
        de verbranding van aardolie, aardgas en steenkool. Als de uitstoot van broeikasgassen in hetzelfde tempo
        doorgaat, wordt het steeds
        warmer op aarde, met grote gevolgen voor mens, natuur en milieu.


    </p>

    <br>

    <p class="three">
        <strong> Welke continenten en sectoren veroorzaken de toename van de CO2 uitstoot in de laatste 30 jaar?
        </strong>
    </p>

    <br>

    <p class="three">

        Om antwoord te kunnen geven op deze vragen, dien je naar de CO2 uitstoot te kijken van alle verschillende
        continenten. De CO2 uitstoot wordt onderverdeeld in 4 sectoren waaronder: Energy, Industrial Processes, Land use
        change and forestry en Bunker fuels.
        Met behulp van de CO2 uitstoot per continent en sector, kan worden aangetoond waar de toename van de CO2 vandaan
        komt.

    </p>

    <br>
    <br>
    <hr class="line">

    <p class="four">
        EEN AANTAL INVLOEDRIJKE SECTOREN DRAGEN BIJ AAN DE OPWARMING
    </p>

    <h2>
        Welke sectoren dragen bij aan Climate Change?
        <br>
        <br>
    </h2>

    <h3>
        Energy Sector
    </h3>

    <p class="five">

        Deze omvat alle emissies die voortvloeien uit de omzetting van energie.<br> De CO2 uitstoot van de energy sector
        is een totaal dat wordt berekend <br> op basis van de CO2 uitstoot van alle sub sectoren binnen de Energy <br>
        sector. Subcategorieën
        bevatten: Electricity and Heat, Manufacturing <br> and Construction, Transportation, Other Fuel Combustion,
        Fugitive <br> Emissions en Buildings.
    </p>

    <h3>
        Land Use Change and Forestry sector
    </h3>

    <p class="five">
        Dit is een zeer belangrijke categorie en omvat een reeks bronnen van broeikasgassen. In het bijzonder
        reflecteert het grote hoeveelheden CO2 en methaan die worden uitgestoten bij natuurlijk landgebruik (bosbouw,
        permanent grasland, wetland, enz.) worden
        omgezet voor ander gebruik zoals landbouw. Binnen deze sector is sprake van negatieve CO2 emissies, hiervoor
        moet een bedrijf, sector of land meer CO2 uit de atmosfeer halen dan het uitstoot.
    </p>

    <h3>
        Industrial Processes sector
    </h3>

    <p class="five">
        Deze omvatten emissies die voortkomen uit industriële productie anders dan door energieverbruik. Een belangrijk
        onderdeel van deze categorie is CO2 dat komt vrij wanneer kalksteen wordt omgezet in cement.

    </p>

    <h3>
        Bunker Fuels sector
    </h3>

    <p class="five">
        Deze zijn opgenomen in ‘andere sectoren’ om hun specialiteit weer te geven status onder het UNFCCC-regime. Ze
        vertegenwoordigen echter emissies van het verbranden van bunkerbrandstoffen in de internationale scheepvaart en
        luchtvaart, echter zouden ze
        dit moeten doen in de praktijk binnen de sector energie en in de sub sector transport.
    </p>
    <br>
    <br>
    <hr class="line">

    <h2>Climate change over the last 30 years</h2>
    <br>



    <img src="Group 1038.png" alt="energy" class="energy">
    <img src="Group 1040.png" alt="forestry" class="forestry">
    <img src="Group 1041.png" alt="industrial" class="industrial">
    <img src="Group 1042.png" alt="bunkerfuels" class="bunkerfuels">

    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://d3js.org/topojson.v2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@turf/turf@5/turf.min.js"></script>


    <svg width="960" height="600" style="position: absolute; top:-1000px; left: -1000px;">
        <defs>

            <path id="forestry"
                d="M5.79,6.08H5.43a.57.57,0,0,0-.59.56v.9H4.46V5.83H6.12a.11.11,0,0,0,.12-.12v-.6a.49.49,0,0,0-.51-.49H5.35a.57.57,0,0,0-.45-.3L5,4h.49v.12a.14.14,0,0,0,.13.13h.51a.13.13,0,0,0,.13-.13V3.4a.13.13,0,0,0-.13-.12H5.58a.14.14,0,0,0-.13.12v.37H5l.14-.85h.59a.13.13,0,0,0,.13-.12.62.62,0,0,0-.64-.61H5.1V1.09A.13.13,0,0,0,5,1H4.84V.12A.12.12,0,0,0,4.71,0a.12.12,0,0,0-.12.12V1H4.21a.13.13,0,0,0-.13.12v1.1H1.15a.62.62,0,0,0-.64.61.13.13,0,0,0,.13.12h.59l.14.85H.89V3.4a.13.13,0,0,0-.13-.12H.25a.13.13,0,0,0-.12.12v.73a.12.12,0,0,0,.12.12H.76a.12.12,0,0,0,.13-.12V4h.52l.06.31a.57.57,0,0,0-.45.3H.64a.49.49,0,0,0-.51.49v.6a.12.12,0,0,0,.12.12H1.91V7.54H1.53v-.9A.57.57,0,0,0,1,6.08H.58A.57.57,0,0,0,0,6.64V8.93a.57.57,0,0,0,.58.55H1a.57.57,0,0,0,.58-.55V7.78h.38V7.9A.12.12,0,0,0,2,8H4.33a.12.12,0,0,0,.13-.12V7.78h.38V8.93a.57.57,0,0,0,.59.55h.36a.57.57,0,0,0,.58-.55V6.64A.57.57,0,0,0,5.79,6.08ZM5.71,3.52H6V4H5.71ZM4.33,1.22h.51v1c-.24,0-.39,0-.5,0h0ZM.64,4H.38V3.53H.64Zm.63,4.92A.32.32,0,0,1,1,9.24H.58a.34.34,0,0,1-.33-.31V6.64a.34.34,0,0,1,.33-.32H1a.32.32,0,0,1,.32.32ZM5.16,4.86a.32.32,0,0,1-.3.34.32.32,0,1,1,0-.64h0A.31.31,0,0,1,5.16,4.86Zm-4-2.43H5.22a.41.41,0,0,1,.37.24H.79A.38.38,0,0,1,1.15,2.43Zm3.73.49L4.64,4.35a.58.58,0,0,0-.31.27H2a.58.58,0,0,0-.31-.27L1.49,2.92ZM1.53,4.56a.3.3,0,0,1,.29.32.32.32,0,0,1-.32.29.31.31,0,0,1,0-.61ZM.38,5.11a.26.26,0,0,1,.26-.25H1a.57.57,0,0,0,.6.55.57.57,0,0,0,.54-.55H4.27a.58.58,0,0,0,1.15,0h.31A.26.26,0,0,1,6,5.11v.48H.38ZM4.21,7.78h-2V5.84h2ZM6.12,8.93a.33.33,0,0,1-.33.31H5.43a.32.32,0,0,1-.33-.31V6.64a.32.32,0,0,1,.33-.32h.36a.33.33,0,0,1,.33.32Z" />


            <path id="bunkerfuels"
                d="M9.89,9.2a.88.88,0,0,0-.68.32.73.73,0,0,1-.54.27.71.71,0,0,1-.54-.27,1.2,1.2,0,0,0-.33-.25l.7-3.48a.33.33,0,0,0-.17-.35L8,5.29,7.59,3.42a.34.34,0,0,0-.31-.24H7.16L7,2.44a.34.34,0,0,0-.31-.24H6.43l-.19-.74a.32.32,0,0,0-.31-.24H5.11V.1A.1.1,0,0,0,5,0a.11.11,0,0,0-.12.09h0V1.22H4.07a.32.32,0,0,0-.31.24l-.19.74H3.33A.31.31,0,0,0,3,2.44l-.18.74H2.72a.33.33,0,0,0-.31.25L2,5.29l-.3.15a.32.32,0,0,0-.17.35l.7,3.48a1.2,1.2,0,0,0-.33.25.73.73,0,0,1-.54.27.73.73,0,0,1-.54-.27A.92.92,0,0,0,.11,9.2C0,9.21,0,9.26,0,9.32a.13.13,0,0,0,.11.1.68.68,0,0,1,.53.26.94.94,0,0,0,.69.32A.88.88,0,0,0,2,9.68a.69.69,0,0,1,1.08,0,.94.94,0,0,0,.68.32.91.91,0,0,0,.69-.32.68.68,0,0,1,1.07,0,.92.92,0,0,0,.69.32.9.9,0,0,0,.68-.32.7.7,0,0,1,.55-.27A.68.68,0,0,1,8,9.67a.88.88,0,0,0,.68.32.91.91,0,0,0,.69-.32.72.72,0,0,1,.54-.26c.07,0,.12-.06.11-.12a.11.11,0,0,0-.11-.09ZM4,1.52a.12.12,0,0,1,.11-.09H5.93A.11.11,0,0,1,6,1.52v0H5.72c-.07,0-.12.06-.11.12a.13.13,0,0,0,.11.1H6.1l.11.42H3.79Zm-.73,1a.11.11,0,0,1,.1-.08H6.67a.1.1,0,0,1,.1.08L7,3.18H3.06Zm-.61,1a.11.11,0,0,1,.1-.08H7.28a.1.1,0,0,1,.1.08l0,.08H7.05a.12.12,0,0,0-.11.12.14.14,0,0,0,.11.1h.4l0,.1H7.22c-.07,0-.12.06-.11.12a.13.13,0,0,0,.11.1h.26l0,0,.26,1.1L5.05,3.8H5L2.22,5.17Zm1.69,6a.71.71,0,0,1-.54.27.71.71,0,0,1-.53-.27.94.94,0,0,0-.69-.32l-.15,0L1.88,6.61h.35c.07,0,.12-.07.11-.12a.13.13,0,0,0-.11-.1H1.84l0-.22H2a.11.11,0,0,0,.1-.12A.1.1,0,0,0,2,6h-.2l0-.22a.1.1,0,0,1,.06-.1L4.89,4.07V9.2A1,1,0,0,0,4.31,9.52Zm2.45,0a.71.71,0,0,1-.54.27.67.67,0,0,1-.53-.27,1,1,0,0,0-.58-.32V4.07L8.23,5.64a.11.11,0,0,1,.06.11L7.83,8H7.47c-.07,0-.12.06-.11.12a.11.11,0,0,0,.11.09h.32l0,.23h-.8c-.07,0-.12.06-.11.12a.12.12,0,0,0,.11.09H7.7l-.11.53H7.45a.89.89,0,0,0-.69.32Zm-3.23-4a.73.73,0,0,0-.71.72.72.72,0,1,0,1.43,0A.67.67,0,0,0,4,5.71.72.72,0,0,0,3.53,5.5Zm0,1.23A.51.51,0,0,1,3,6.22a.51.51,0,0,1,1,0,.51.51,0,0,1-.15.36.51.51,0,0,1-.36.15Zm3.65-.51a.72.72,0,1,0-.71.72.71.71,0,0,0,.71-.72Zm-.71.51A.51.51,0,0,1,6,6.22a.5.5,0,0,1,.51-.5.5.5,0,0,1,.5.5.5.5,0,0,1-.5.51ZM7.19,8l0,0a.09.09,0,0,1,0,.08V8.2h0a.11.11,0,0,1-.14,0h0V8.14s0,0,0,0l0,0h0l0,0ZM2.63,6.42a.11.11,0,0,1,0,.08s0,.1-.11.11h0l0,0a.11.11,0,0,1,0-.15l0,0A.11.11,0,0,1,2.63,6.42Zm4-2.68a.1.1,0,0,1,0-.16l0,0a.13.13,0,0,1,.12,0,.11.11,0,0,1,0,.12s0,.06-.1.07h0ZM5.47,1.59a.13.13,0,0,1,0,.12l0,0,0,0H5.32s0,0,0,0a.06.06,0,0,1,0,0v0s0,0,0,0v0h0a0,0,0,0,1,0,0h.08A.05.05,0,0,1,5.47,1.59ZM4.71,7.12v.64s0,.09-.09.1a.12.12,0,0,1-.12-.09h0V7.12A.1.1,0,0,1,4.6,7a.09.09,0,0,1,.11.08Zm0,1v.21a.09.09,0,0,1-.09.1A.1.1,0,0,1,4.5,8.3h0V8.08A.09.09,0,0,1,4.6,8a.09.09,0,0,1,.11.08Zm1-5.28a.1.1,0,0,1-.11.1H5c-.07,0-.12-.06-.11-.12A.12.12,0,0,1,5,2.69h.63a.1.1,0,0,1,.11.11Zm-1,0a.09.09,0,0,1-.1.1H4.41a.11.11,0,0,1-.1-.12.12.12,0,0,1,.1-.09h.22A.1.1,0,0,1,4.73,2.8Zm-1.81.84-.08.42a.1.1,0,0,1-.1.08h0A.11.11,0,0,1,2.63,4l.08-.42a.12.12,0,0,1,.12-.09h0a.12.12,0,0,1,.09.13Zm-.14.73,0,.21a.1.1,0,0,1-.1.09h0s-.06,0-.07,0a.11.11,0,0,1,0-.08l0-.21a.12.12,0,0,1,.12-.09h0a.13.13,0,0,1,.09.13Z" />

            <path id="industrial"
                d="M10,9.37V7a.12.12,0,0,0-.12-.12H9.26V5.79a.14.14,0,0,0,0-.09s-.06,0-.09,0H5.45a.09.09,0,0,0-.09,0,.14.14,0,0,0,0,.09V6.87h-1a7.94,7.94,0,0,1-.53-2.41.92.92,0,0,0,.59,0,.83.83,0,0,0,.53.16.94.94,0,0,0,.73.34,1,1,0,0,0,1-1,1.07,1.07,0,0,0-.26-.72A.67.67,0,0,0,6,2.26l-.13,0a1.32,1.32,0,0,0,.06-.39A1.27,1.27,0,0,0,5.07.56a1.2,1.2,0,0,0-1.39.54,1.07,1.07,0,0,0-1.47.39,1.25,1.25,0,0,0-.14.41,1.41,1.41,0,0,0-.33.67,1.15,1.15,0,0,0-.41.91,1.24,1.24,0,0,0,.18.64A8.76,8.76,0,0,1,.8,7.18L0,9A.07.07,0,0,0,0,9v.33a.12.12,0,0,0,0,.09.08.08,0,0,0,.09,0H9.88a.08.08,0,0,0,.09,0A.12.12,0,0,0,10,9.37ZM5.56,5.91H9v1H5.56Zm.78,1.2V9.25H5.42V7.11Zm.23,0h.91V9.25H6.57Zm1.14,0h.92V9.25H7.71Zm-2.52,0V9.25h0V9L4.41,7.12h.78ZM1.75,3.81H3.52a10.34,10.34,0,0,0,.07,1.11H1.66A10.17,10.17,0,0,0,1.75,3.81Zm.16-1.07A.13.13,0,0,0,2,2.67a1.08,1.08,0,0,1,.31-.62.24.24,0,0,0,0-.08.89.89,0,0,1,.86-.78.84.84,0,0,1,.5.17.1.1,0,0,0,.09,0,.16.16,0,0,0,.08-.06A1,1,0,0,1,5,.77a1,1,0,0,1,.76,1.05,1.14,1.14,0,0,1-.1.45.13.13,0,0,0,0,.12.09.09,0,0,0,.1,0h0a.46.46,0,0,1,.42.45.39.39,0,0,1-.07.23.16.16,0,0,0,0,.15.84.84,0,0,1,.21.89.75.75,0,0,1-1,.48A.81.81,0,0,1,5,4.39a.13.13,0,0,0-.09,0h0a.67.67,0,0,1-.47-.16.09.09,0,0,0-.12,0,.78.78,0,0,1-.58,0V3.69a.13.13,0,0,0-.11-.12h-2a.09.09,0,0,0-.07,0,.25.25,0,0,1,0-.12,1,1,0,0,1,.35-.74ZM3.26,9.25h-3V9.06L1,7.29a9.15,9.15,0,0,0,.62-2.13h2A8.65,8.65,0,0,0,4.2,7.22L5,9.06v.19Zm6.51,0H8.86V7.11h.91Z" />

            <path id="energy"
                d="M3.28,8.16,4.82,5.34H3.49l1.3-3.06H6.4l-1,1.88H7Zm.55-3H5.19L4.34,6.68l2.1-2.29H5L6,2.5H4.93ZM3.45,9.78A4.79,4.79,0,0,1,.31,6.07l-.22,0A5,5,0,0,0,3.39,10ZM4.89,0V.23A4.78,4.78,0,0,1,9.55,5.12h.22A5,5,0,0,0,4.89,0ZM.41,3.74.2,3.67A5.51,5.51,0,0,0,0,5.12H.22A5,5,0,0,1,.41,3.74ZM4.89,9.45A4.24,4.24,0,0,1,.76,5.12,4.23,4.23,0,0,1,4.89.8a4,4,0,0,1,.69.06A4.27,4.27,0,0,1,9,5.12,4.23,4.23,0,0,1,4.89,9.45ZM4.89,1A4,4,0,0,0,1,5.12a4,4,0,0,0,3.91,4.1,4,4,0,0,0,3.9-4.1A4,4,0,0,0,4.89,1Z" />
        </defs>
    </svg>



    <script>
        let formatDateIntoYear = d3.timeFormat("%Y");

        let startDate = new Date("1990")
        let endDate = new Date("2018");

        let margin = {
            top: 50,
            right: 50,
            bottom: 0,
            left: 50
        },
            width = 960 - margin.left - margin.right,
            height = 650 - margin.top - margin.bottom;


        let svg = d3.select("body").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom);

        let projection = d3.geoMercator()
            .scale(width / 2 / Math.PI)
            .translate([width / 2, height / 2])
            .rotate([-10, 0]);

        let path = d3.geoPath().projection(projection);

        let regionFilter = ["Asia", "Europe", "Africa", "North America", "South America", "Oceanie"];
        let sectorFilter = ["Energy", "Industrial Processes", "Land-Use Change and Forestry", "Bunker Fuels"];
        let filter = function (d) {
            console.log(d)
            if (regionFilter.indexOf(d["RegionName"]) !== -1 && sectorFilter.indexOf(d["Sector"]) !== -1) {
                return d;
            }
        }


        /////inladen data en landkaart/////
        let url = "https://piwodlaiwo.github.io/topojson//world-continents.json";
        d3.csv("Historical_emissions_4_sectors.csv").then(function (myData) {
            d3.json(url).then(function (topology) {

                function getUnqiueValues(data, property) {
                    let allValues = data.map(e => e[property]);
                    let uniqueValues = allValues.filter((value, index, self) => {
                        return self.indexOf(value) === index;
                    });
                    return uniqueValues;
                }


                ////ophalen van de jaren in de data////
                let timeRange = d3.extent(Object.keys(myData[0]), function (d) {
                    if (typeof + d === 'number' && isFinite(+d)) {
                        return +d;
                    }
                });

                let uniquecontinent = getUnqiueValues(myData, "RegionName");
                let uniquesector = getUnqiueValues(myData, "Sector");
                let uniquecountry = getUnqiueValues(myData, "Country");

                let indexedData = {};

                ///Data filteren op jaar,continent,sector en landniveau////

                for (let y = timeRange[0]; y <= timeRange[1]; y++) {
                    let yearKey = y;
                    indexedData[yearKey] = {};
                    for (let i = 0; i < uniquecontinent.length; i++) {
                        let continentKey = uniquecontinent[i];
                        indexedData[yearKey][continentKey] = {}
                        indexedData[yearKey][continentKey]["continenttotal"] = 0

                        for (let j = 0; j < uniquesector.length; j++) {
                            let sectorKey = uniquesector[j];
                            //console.log(sectorKey)
                            indexedData[yearKey][continentKey][sectorKey] = {};
                            indexedData[yearKey][continentKey][sectorKey]["sectortotal"] = 0
                            for (let k = 0; k < uniquecountry.length; k++) {
                                let countryKey = uniquecountry[k];
                                //console.log(countryKey)
                                indexedData[yearKey][continentKey][sectorKey][countryKey] = {};
                            }
                        }
                    }
                }



                ////ophalen van continent en sector total////
                for (let i = 0; i < myData.length; i++) {
                    let continentKey = myData[i]["RegionName"];
                    let sectorKey = myData[i]["Sector"];
                    let countryKey = myData[i]["Country"];

                    for (let y = timeRange[0]; y <= timeRange[1]; y++) {
                        let yearKey = y;
                        let obj = {
                            "emission": myData[i][yearKey],
                            "Gas": myData[i]["Gas"],
                            "Datasource": myData[i]["Data source"]
                        };
                        indexedData[yearKey][continentKey][sectorKey][countryKey] = obj;
                        indexedData[yearKey][continentKey]["continenttotal"] += +obj.emission;
                        indexedData[yearKey][continentKey][sectorKey]["sectortotal"] += +obj.emission;
                    }

                }

                ////ophalen van de minimale en maximale C02 waarde van alle jaren////
                let dataMinMax = d3.extent(d3.merge(Object.values(indexedData["2018"]).map(function (d) {
                    //console.log(Object.values(d))
                    return Object.values(d);
                })), function (d) {
                    if (typeof d["sectortotal"] !== 'undefined') {

                        return d["sectortotal"];
                    }
                });

                ////toewijzen van de continenten op de wereldkaart aan de juiste continenten in de dataset////

                let continents = topojson.feature(topology, topology.objects.continent).features;
                let centroids = continents.map(function (feature) {
                    let result = path.centroid(feature);
                    result.push(feature.properties.continent);
                    return result;

                });

                svg.selectAll(".continent")
                    .data(continents)
                    .enter()
                    .append("path")
                    .attr("d", path)
                    .attr("title", function (d, i) {
                        return d.properties.continent;
                    })
                    .style("fill", "#FFFFFF")
                    .style("opacity", "25%")

                
                ////functie die SVG's transformeert in dit geval voor de iconen////

                function getTransform(element, x, y, scale) {
                    //x = new x position
                    //y = new y position
                    //scale = size of the shape

                    let reference = element;
                    let box = reference.node().getBBox();
                    let centerX = box.x + box.width / 2;
                    let centerY = box.y + box.height / 2;
                    let scaleAmount = scale;

                    //formula for the translate to scale the shape from its center
                    let translateX = (1 - scaleAmount) * centerX;
                    let translateY = (1 - scaleAmount) * centerY;

                    // to move this shape to x:100 and y:200 in the SVG:
                    let posX = x;
                    translateX += posX - box.width / 2;
                    let posY = y;
                    translateY += posY - box.height / 2;

                    // first scale the shape, then put it back in place. Transform is read from right to left
                    let transform = `translate(${translateX},${translateY}) scale(${scaleAmount}) `;

                    return transform
                }


                //// de scale bepaalt de grootste en kleinste waarde in het domein////
                ////range bepaalt de radius van de cirkels////

                let myScale = d3.scaleLinear()
                    .domain(dataMinMax)
                    .range([20, 70])



                ////tekenen van de cirkels voor elke sector////
                let data = d3.range(1);

                function drawSectorCircles(when) {


                    let exit = svg.selectAll("#cirkels")
                    .remove()

                    exit=svg.selectAll("#iconen")
                    .remove()

                    let update = svg.selectAll("circles")
                        .data(centroids);

                    ////energy sector////
                    let enter = update.enter()
                        .append("circle")
                        .attr("id", "cirkels")
                        .attr("cx", function (d) {
                            return d[0] + 30;
                        })
                        .attr("cy", function (d) {
                            return d[1] - 45;
                        })
                        .attr("r", function (d) {
                            if (indexedData[when][d[2]]["Energy"]["sectortotal"] < 0) {
                                return 0
                            } else {

                                myScale(

                                    indexedData[when][d[2]]["Energy"]["sectortotal"])
                            }
                            return (myScale(indexedData[when][d[2]]["Energy"]["sectortotal"]))


                        })
                        .attr("fill", "#804CC4")

                    ////forestry sector////
                    enter = update.enter()
                        .append("circle")
                        .attr("id", "cirkels")
                        .attr("cx", function (d) {
                            return d[0] - 15;
                        })
                        .attr("cy", function (d) {
                            return d[1] - 35;
                        })
                        .attr("r", function (d) {
                            if (indexedData[when][d[2]]["Land-Use Change and Forestry"]["sectortotal"] < 0) {
                                return 0
                            } else {

                                myScale(

                                    indexedData[when][d[2]]["Land-Use Change and Forestry"]["sectortotal"])
                            }
                            return (myScale(indexedData[when][d[2]]["Land-Use Change and Forestry"]["sectortotal"]))

                        })
                        .attr("fill", "#3C8E40")

                    ////industrial sector////

                    enter = update.enter()
                        .append("circle")
                        .attr("id", "cirkels")
                        .attr("cx", function (d) {
                            return d[0] - 50;
                        })
                        .attr("cy", function (d) {
                            return d[1] + 5;
                        })
                        .attr("r", function (d) {
                            if (indexedData[when][d[2]]["Industrial Processes"]["sectortotal"] < 0) {
                                return 0
                            } else {

                                myScale(

                                    indexedData[when][d[2]]["Industrial Processes"]["sectortotal"])
                            }
                            return (myScale(indexedData[when][d[2]]["Industrial Processes"]["sectortotal"]))

                        })
                        .attr("fill", "#F4AF3A")

                    ////bunker fuels sector////
                    enter = update.enter()
                        .append("circle")
                        .attr("id", "cirkels")
                        .attr("cx", function (d) {
                            return d[0] - 10;
                        })
                        .attr("cy", function (d) {
                            return d[1] + 20;
                        })
                        .attr("r", function (d) {
                            if (indexedData[when][d[2]]["Bunker Fuels"]["sectortotal"] < 0) {
                                return 0
                            } else {

                                myScale(

                                    indexedData[when][d[2]]["Bunker Fuels"]["sectortotal"])
                            }
                            return (myScale(indexedData[when][d[2]]["Bunker Fuels"]["sectortotal"]))
                        })
                        .attr("fill", "#F36565")

                    ////toevoegen van de iconen aan de juiste sectoren////
                    update = svg.selectAll("use")
                        .data(centroids);
                    enter = update.enter()
                        .append("use")
                        .attr("id", "iconen")
                        .attr("xlink:href", "#energy")
                        .attr("transform", (d, i) => {
                            return getTransform(d3.select("path#energy"), d[0] + 30, d[1] - 45, myScale(indexedData[when][d[2]]["Energy"]["sectortotal"]) / 10 * 1.5)


                        })
                        .style("fill", "#FFFF")


                    enter = update.enter()
                        .append("use")
                        .attr("id", "iconen")
                        .attr("xlink:href", "#forestry")
                        .attr("transform", (d, i) => {
                            if (indexedData[when][d[2]]["Land-Use Change and Forestry"]["sectortotal"] < 0) {
                                return getTransform(d3.select("path#forestry"), d[0] - 15, d[1] - 35, 0)
                            } else {
                                return getTransform(d3.select("path#forestry"), d[0] - 15, d[1] - 35, myScale(indexedData[when][d[2]]["Land-Use Change and Forestry"]["sectortotal"]) / 10 * 1.5)
                            }
                            return getTransform(d3.select("path#forestry"), d[0] - 15, d[1] - 35, myScale(indexedData[when][d[2]]["Land-Use Change and Forestry"]["sectortotal"]) / 10 * 1.5)
                        })
                        .style("fill", "#FFFF")


                    enter = update.enter()
                        .append("use")
                        .attr("id", "iconen")
                        .attr("xlink:href", "#industrial")
                        .attr("transform", (d, i) => {
                            return getTransform(d3.select("path#industrial"), d[0] - 50, d[1] + 5, myScale(indexedData[when][d[2]]["Industrial Processes"]["sectortotal"]) / 10 * 1.5)
                        })
                        .style("fill", "#FFFF")



                    enter = update.enter()

                        .append("use")
                        .attr("id", "iconen")
                        .attr("xlink:href", "#bunkerfuels")
                        .attr("transform", (d, i) => {
                            return getTransform(d3.select("path#bunkerfuels"), d[0] - 10, d[1] + 20, myScale(indexedData[when][d[2]]["Bunker Fuels"]["sectortotal"]) / 10 * 1.5)
                        })
                        .style("fill", "#FFFF")

                }

                drawSectorCircles("1990");



                //// maken van de slider voor 1990 tot 2018////

                let moving = false;
                let currentValue = 0;
                let targetValue = width;

                let x = d3.scaleTime()
                    .domain([startDate, endDate])
                    .range([0, targetValue])
                    .clamp(true);
                let slider = svg.append("g")
                    .attr("class", "slider")
                    .attr("transform", "translate(" + margin.left + "," + height / 1.2 + ")");

                slider.append("line")
                    .attr("class", "track")
                    .attr("x1", x.range()[0])
                    .attr("x2", x.range()[1])
                    .select(function () {
                        return this.parentNode.appendChild(this.cloneNode(true));
                    })
                    .attr("class", "track-inset")
                    .select(function () {
                        return this.parentNode.appendChild(this.cloneNode(true));
                    })
                    .attr("class", "track-overlay")
                    .call(d3.drag()
                        .on("start.interrupt", function () {
                            slider.interrupt();
                        })
                        .on("start drag", function () {
                            currentValue = d3.pointer(event, this)[0];
                            aanpassen(x.invert(currentValue));
                        })
                    );

                slider.insert("g", ".track-overlay")
                    .attr("class", "ticks")
                    .attr("transform", "translate(0," + 20 + ")")
                    .selectAll("text")
                    .data(x.ticks(10))
                    .enter()
                    .append("text")
                    .attr("x", x)
                    .attr("y", 10)
                    .attr("text-anchor", "middle")
                    .text(function (d) {
                        return formatDateIntoYear(d);
                    });

                let handle = slider.insert("circle", ".track-overlay")
                    .attr("class", "handle")
                    .attr("r", 9);

                let label = slider.append("text")
                    .attr("class", "label")
                    .attr("text-anchor", "middle")
                    .text(formatDateIntoYear(startDate))
                    .attr("transform", "translate(0," + (-25) + ")")


                //// update position and text of label according to slider scale////
                function aanpassen(h) {

                    handle.attr("cx", x(h));
                    label
                        .attr("x", x(h))
                        .text(formatDateIntoYear(h));
                    drawSectorCircles(formatDateIntoYear(h))
                }


                function step() {
                    update = (x.invert(currentValue));
                    currentValue = currentValue + (targetValue / 151);
                    if (currentValue > targetValue) {
                        moving = false;
                        currentValue = 0;
                        clearInterval(timer);
                    }
                }
            })
        })
    </script>

    <hr class="line">

    <h2>Meer weten over Climate Change? </h2>
    <br>
    <br>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/cNwWjC1TNJw" title="YouTube video player"
        frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen></iframe>
    <br>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/-6QAKBYhIRo" title="YouTube video player"
        frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen></iframe>

</body>

</html>